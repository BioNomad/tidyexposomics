% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/associate_exposure_outcome.R
\name{associate_exposure_outcome}
\alias{associate_exposure_outcome}
\title{Perform Exposure-Wide Association Study (ExWAS) Analysis}
\usage{
associate_exposure_outcome(
  expomicset,
  exposures,
  outcome,
  covariates = NULL,
  family = "gaussian",
  correction_method = "fdr",
  action = "add"
)
}
\arguments{
\item{expomicset}{An \code{expomicset} object containing exposure and outcome data.}

\item{exposures}{A character vector of exposure variable names.}

\item{outcome}{A character string specifying the outcome variable name.}

\item{covariates}{An optional character vector of covariate names. Default is \code{NULL}.}

\item{family}{A character string specifying the GLM family (e.g., \code{"gaussian"}, \code{"binomial"}). Default is \code{"gaussian"}.}

\item{correction_method}{A character string specifying the multiple testing correction method (e.g., \code{"fdr"}, \code{"bonferroni"}). Default is \code{"fdr"}.}

\item{action}{A character string indicating whether to return results (\code{"get"}) or add them to metadata (\code{"add"}). Default is \code{"add"}.}
}
\value{
If \code{action = "add"}, returns the modified \code{expomicset} with ExWAS results stored in metadata.
If \code{action = "get"}, returns a list containing:
\item{results_df}{A data frame with model estimates, standard errors, p-values, and adjusted p-values.}
\item{covariates}{The covariates used in the models.}
}
\description{
Fits generalized linear models (GLMs) to assess associations between multiple exposures
and an outcome, adjusting for covariates. Applies multiple testing correction and
optionally stores results in \code{expomicset} metadata.
}
\details{
The function iterates over exposures, fits a GLM for each, extracts model statistics,
adjusts p-values for multiple testing, and optionally stores results in \code{expomicset} metadata.
The function handles errors in model fitting gracefully and logs progress with messages.
}
\examples{
\dontrun{
results <- associate_exposure_outcome(
  expomicset = my_expomicset,
  exposures = c("pm25", "lead", "ozone"),
  outcome = "lung_function",
  covariates = c("age", "sex", "smoking"),
  family = "gaussian",
  correction_method = "fdr",
  action = "get"
)
}

}
