% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_heatmap_correlate_exposure.R
\name{plot_heatmap_correlate_exposure}
\alias{plot_heatmap_correlate_exposure}
\title{Correlation Heatmap of Exposure Variables with Category Annotations}
\usage{
plot_heatmap_correlate_exposure(
  expomicset,
  exposure_cols = NULL,
  corr_threshold = NULL,
  annotation_colors = NULL,
  low = "#006666",
  mid = "white",
  high = "#8E0152",
  midpoint = 0
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing exposure data and correlation results.}

\item{exposure_cols}{A character vector of exposure variable names to include in the plot. If \code{NULL}, includes all.}

\item{corr_threshold}{A numeric value for filtering correlations by absolute value (e.g., \code{0.2}).}

\item{annotation_colors}{Optional named character vector of colors for exposure categories.}

\item{low}{Color for strong negative correlations. Default is \code{"#006666"}.}

\item{mid}{Color for zero correlation. Default is \code{"white"}.}

\item{high}{Color for strong positive correlations. Default is \code{"#8E0152"}.}

\item{midpoint}{Midpoint for the color scale. Default is \code{0}.}
}
\value{
A \code{ggplot2} object assembled using \code{patchwork}, showing the correlation heatmap and annotation bars.
}
\description{
Generates an upper-triangle \strong{heatmap} of correlations between exposure variables,
with side annotation bars indicating variable categories.
}
\details{
This function:
\itemize{
\item Uses precomputed correlations from \code{metadata(expomicset)$exposure_correlation$correlation_table}.
\item Filters to an upper triangle matrix (i.e., only combinations where \code{var1 <= var2}).
\item Applies optional thresholding with \code{corr_threshold} to simplify visualization.
\item Adds \strong{top and left annotation bars} colored by \code{category_1} and \code{category_2}, respectively.
\item Harmonizes category colors across both axes using a single legend.
}

If \code{annotation_colors} is not supplied, a default palette is used. The resulting plot includes the heatmap, the sidebars, and a unified legend for variable categories.
}
\examples{
\dontrun{
plot_heatmap_correlate_exposure(expom)
plot_heatmap_correlate_exposure(expom, exposure_cols = c("pm25", "no2", "age"))
plot_heatmap_correlate_exposure(expom, corr_threshold = 0.2)
}

}
