% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_correlation.R
\name{run_correlation}
\alias{run_correlation}
\title{Generalized Correlation Analysis Between Exposures and Features}
\usage{
run_correlation(
  expomicset,
  feature_type = c("degs", "omics", "factors", "factor_features", "exposures"),
  exposure_cols = NULL,
  variable_map = NULL,
  robust = FALSE,
  score_col = "stability_score",
  score_thresh = NULL,
  correlation_method = "spearman",
  correlation_cutoff = 0.3,
  cor_pval_column = "p.value",
  pval_cutoff = 0.05,
  deg_pval_col = "adj.P.Val",
  deg_logfc_col = "logFC",
  deg_pval_thresh = 0.05,
  deg_logfc_thresh = log2(1.5),
  batch_size = 1500,
  action = c("add", "get")
)
}
\arguments{
\item{expomicset}{A MultiAssayExperiment object.}

\item{feature_type}{One of "degs", "omics", "factors", "factor_features", or "exposures".}

\item{exposure_cols}{Optional character vector of exposure variable names. If NULL, all numeric exposures are used.}

\item{variable_map}{Optional variable mapping table (only for omics).}

\item{robust}{If TRUE and feature_type == "degs", restrict to stable DEGs.}

\item{score_col}{Column name for stability scores in sensitivity analysis.}

\item{score_thresh}{Optional numeric threshold for feature stability scores.}

\item{correlation_method}{Correlation method ("spearman", "pearson", etc.).}

\item{correlation_cutoff}{Threshold for absolute correlation.}

\item{cor_pval_column}{Which p-value column to apply cutoff to.}

\item{pval_cutoff}{Significance threshold for p-values.}

\item{deg_pval_col}{DEG p-value column name.}

\item{deg_logfc_col}{DEG logFC column name.}

\item{deg_pval_thresh}{DEG p-value filter threshold.}

\item{deg_logfc_thresh}{DEG logFC filter threshold.}

\item{batch_size}{Features per correlation batch.}

\item{action}{Either "get" (return table) or "add" (update metadata).}
}
\value{
If action = "add", returns modified MultiAssayExperiment. Else, returns correlation result table.
}
\description{
Performs correlation analysis between exposures and a selected feature set (DEGs, omics, latent factors, or exposures).
}
