% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_factor_overlap.R
\name{run_factor_overlap}
\alias{run_factor_overlap}
\title{Identify and Annotate Shared Top Features Across Integration Factors}
\usage{
run_factor_overlap(
  expomicset,
  robust_comparison = TRUE,
  stability_score = NULL,
  score_col = "stability_score",
  pval_thresh = 0.05,
  logfc_thresh = log2(1.5),
  pval_col = "padj",
  logfc_col = "logFC",
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} containing \code{top_factor_features} in its metadata (usually generated by \code{extract_top_factor_features()}).}

\item{robust_comparison}{Logical; if \code{TRUE}, uses sensitivity analysis (if available) to define robust associations. If \code{FALSE}, uses traditional DEG filters. Default is \code{TRUE}.}

\item{stability_score}{Optional numeric threshold for robust filtering. If \code{NULL}, uses the \code{score_thresh} stored in \code{metadata(expomicset)$sensitivity_analysis}.}

\item{score_col}{Character string specifying which score column to use from sensitivity analysis. Default is \code{"stability_score"}.}

\item{pval_thresh}{P-value threshold for differential abundance filtering. Used if \code{robust_comparison = FALSE}. Default is \code{0.05}.}

\item{logfc_thresh}{Log fold change threshold for differential abundance filtering. Used if \code{robust_comparison = FALSE}. Default is \code{log2(1.5)}.}

\item{pval_col}{Character string specifying the column in the differential abundance table containing p-values. Default is \code{"padj"}.}

\item{logfc_col}{Character string specifying the column in the differential abundance table containing log fold changes. Default is \code{"logFC"}.}

\item{action}{What to do with the results:
\describe{
\item{"add"}{Store shared top features in \code{metadata(expomicset)$common_top_factor_features} and return the updated object.}
\item{"get"}{Return the data frame of shared top features across all factors, including an \code{is_deg} column indicating outcome association.}
}}
}
\value{
Either a modified \code{MultiAssayExperiment} object (if \code{action = "add"}), or a \code{data.frame} of overlapping top features (if \code{action = "get"}).
}
\description{
Identifies top features that are shared (overlapping) across all integration factors (e.g., MOFA or MCIA),
and optionally annotates whether these features are also robustly associated with the outcome (e.g., DEGs or stability-selected).
}
