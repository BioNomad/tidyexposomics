% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlate_exposures_factors.R
\name{correlate_exposures_factors}
\alias{correlate_exposures_factors}
\title{Correlate Factor Features with Exposures}
\usage{
correlate_exposures_factors(
  expomicset,
  exposure_cols = NULL,
  correlation_method = "spearman",
  correlation_cutoff = 0.3,
  cor_pval_column = "p.value",
  pval_cutoff = 0.05,
  batch_size = 1500,
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing factor feature information.}

\item{exposure_cols}{An optional character vector of exposure variable names. If \code{NULL}, all numeric exposures are used. Default is \code{NULL}.}

\item{correlation_method}{A character string specifying the correlation method (\code{"spearman"}, \code{"pearson"}, or \code{"kendall"}). Default is \code{"spearman"}.}

\item{correlation_cutoff}{A numeric threshold for absolute correlation values to retain results. Default is \code{0.3}.}

\item{cor_pval_column}{A character string specifying the column name for correlation p-values. Default is \code{"p.value"}.}

\item{pval_cutoff}{A numeric threshold for statistical significance in correlation analysis. Default is \code{0.05}.}

\item{batch_size}{An integer specifying the number of features to process in each batch. Default is \code{1500}.}

\item{action}{A character string indicating whether to return results (\code{"get"}) or add them to metadata (\code{"add"}). Default is \code{"add"}.}
}
\value{
If \code{action = "add"}, returns the modified \code{expomicset} with correlation results stored in metadata.
If \code{action = "get"}, returns a data frame containing:
\item{exposure}{The exposure variable tested.}
\item{feature}{The factor feature tested.}
\item{estimate}{The correlation coefficient.}
\item{p.value}{The correlation p-value.}
\item{FDR}{The adjusted p-value (false discovery rate).}
\item{exp_name}{The experiment from which the feature originated.}
}
\description{
Performs correlation analysis between factor-contributing features and exposure variables.
Supports batch processing for large datasets and multiple testing correction.
}
\details{
The function extracts factor-contributing features from \code{metadata(expomicset)}, filters them based on experiment type,
and correlates them with numeric exposure variables in \code{colData(expomicset)}. Correlations are computed in batches
using the specified method, and p-values are adjusted using FDR correction.
}
\examples{
\dontrun{
results <- correlate_exposures_factors(
  expomicset = expom,
  exposure_cols = c("PM2.5", "NO2"),
  correlation_method = "spearman",
  action = "get"
)
}

}
