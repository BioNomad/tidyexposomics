% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_differential_abundance.R
\name{run_differential_abundance}
\alias{run_differential_abundance}
\title{Perform Differential Abundance Analysis}
\usage{
run_differential_abundance(
  expomicset,
  formula,
  abundance_col = "counts",
  minimum_counts = 10,
  minimum_proportion = 0.3,
  method = "limma_voom",
  contrasts = NULL,
  scaling_method = "none",
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing omics and exposure data.}

\item{formula}{A model formula for differential testing.}

\item{abundance_col}{A character string specifying the assay data column to use. Default is \code{"counts"}.}

\item{minimum_counts}{An integer specifying the minimum count threshold for feature filtering. Default is \code{10}.}

\item{minimum_proportion}{A numeric specifying the minimum proportion of samples with nonzero counts. Default is \code{0.3}.}

\item{method}{A character string specifying the differential abundance method (\code{"limma_voom"}, \code{"DESeq2"}, etc.). Default is \code{"limma_voom"}.}

\item{contrasts}{A character vector specifying contrasts for differential testing. Default is \code{NULL}.}

\item{scaling_method}{A character string specifying normalization/scaling. Default is \code{"none"}.}

\item{action}{A character string specifying \code{"add"} (store results in metadata) or \code{"get"} (return results). Default is \code{"add"}.}
}
\value{
If \code{action="add"}, returns the updated \code{expomicset}.
If \code{action="get"}, returns a \code{data.frame} with differential abundance results, including:
\item{feature}{Feature identifier.}
\item{exp_name}{Assay name.}
\item{logFC}{Log-fold change.}
\item{adj.P.Val}{Adjusted p-value.}
}
\description{
Runs differential abundance testing across all assays in a \code{MultiAssayExperiment} object.
}
\details{
This function:
\itemize{
\item Iterates over all assays in \code{expomicset}.
\item Updates sample metadata in each assay.
\item Runs \code{.run_se_differential_abundance()} for differential testing.
\item Filters results based on \code{minimum_counts} and \code{minimum_proportion}.
\item Combines results across assays.
\item Stores results in \code{metadata(expomicset)$differential_abundance} when \code{action="add"}.
}
}
\examples{
\dontrun{
expom <- run_differential_abundance(
  expomicset = expom,
  formula = ~ condition,
  abundance_col = "counts",
  method = "limma_voom"
)
}

}
