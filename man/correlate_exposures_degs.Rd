% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlate_exposures_degs.R
\name{correlate_exposures_degs}
\alias{correlate_exposures_degs}
\title{Correlate Differentially Expressed Genes (DEGs) with Exposures}
\usage{
correlate_exposures_degs(
  expomicset,
  exposure_cols = NULL,
  robust = TRUE,
  score_thresh = NULL,
  correlation_method = "spearman",
  correlation_cutoff = 0.3,
  cor_pval_column = "p.value",
  pval_cutoff = 0.05,
  batch_size = 1500,
  deg_pval_col = "adj.P.Val",
  deg_logfc_col = "logFC",
  deg_pval_thresh = 0.05,
  deg_logfc_thresh = log2(1.5),
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing differential expression results.}

\item{exposure_cols}{An optional character vector of exposure variable names. If \code{NULL}, all numeric exposures are used. Default is \code{NULL}.}

\item{robust}{A logical value indicating whether to use sensitivity analysis to filter DEGs. Default is \code{TRUE}.}

\item{score_thresh}{An optional numeric threshold for feature stability scores in sensitivity analysis. If \code{NULL}, the default threshold from metadata is used. Default is \code{NULL}.}

\item{correlation_method}{A character string specifying the correlation method (\code{"spearman"}, \code{"pearson"}, or \code{"kendall"}). Default is \code{"spearman"}.}

\item{correlation_cutoff}{A numeric threshold for absolute correlation values to retain results. Default is \code{0.3}.}

\item{cor_pval_column}{A character string specifying the column name for correlation p-values. Default is \code{"p.value"}.}

\item{pval_cutoff}{A numeric threshold for statistical significance in correlation analysis. Default is \code{0.05}.}

\item{batch_size}{An integer specifying the number of features to process in each batch. Default is \code{1500}.}

\item{deg_pval_col}{A character string specifying the column name for DEG p-values. Default is \code{"adj.P.Val"}.}

\item{deg_logfc_col}{A character string specifying the column name for DEG log fold changes. Default is \code{"logFC"}.}

\item{deg_pval_thresh}{A numeric threshold for filtering DEGs based on p-values. Default is \code{0.05}.}

\item{deg_logfc_thresh}{A numeric threshold for filtering DEGs based on absolute log fold change. Default is \code{log2(1.5)}.}

\item{action}{A character string indicating whether to return results (\code{"get"}) or add them to metadata (\code{"add"}). Default is \code{"add"}.}
}
\value{
If \code{action = "add"}, returns the modified \code{expomicset} with correlation results stored in metadata.
If \code{action = "get"}, returns a data frame containing:
\item{exposure}{The exposure variable tested.}
\item{feature}{The DEG tested.}
\item{estimate}{The correlation coefficient.}
\item{p.value}{The correlation p-value.}
\item{FDR}{The adjusted p-value (false discovery rate).}
\item{exp_name}{The experiment from which the DEG originated.}
}
\description{
Performs correlation analysis between DEGs and exposure variables, with optional
filtering based on sensitivity analysis results. Supports batch processing for
large datasets and multiple testing correction.
}
\details{
The function extracts DEGs from \code{metadata(expomicset)}, filters them based on p-value and log fold change thresholds,
and correlates them with numeric exposure variables in \code{colData(expomicset)}. If \code{robust = TRUE}, only stable DEGs
from sensitivity analysis are used. Correlations are computed in batches using the specified method, and p-values are
adjusted using the Benjamini-Hochberg FDR correction.
}
\examples{
\dontrun{
results <- correlate_exposures_degs(
  expomicset = expom,
  exposure_cols = c("PM2.5", "NO2"),
  robust = TRUE,
  correlation_method = "spearman",
  action = "get"
)
}

}
