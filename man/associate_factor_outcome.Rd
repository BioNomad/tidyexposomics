% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/associate_factor_outcome.R
\name{associate_factor_outcome}
\alias{associate_factor_outcome}
\title{Associate Latent Factors with an Outcome}
\usage{
associate_factor_outcome(
  expomicset,
  outcome_var,
  categorical = FALSE,
  p_thresh = 0.05,
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing integration results.}

\item{outcome_var}{A character string specifying the outcome variable name.}

\item{categorical}{A logical value indicating whether the outcome is categorical (\code{TRUE}) or continuous (\code{FALSE}). Default is \code{FALSE}.}

\item{p_thresh}{A numeric value specifying the p-value threshold for significance filtering. Default is \code{0.05}.}

\item{action}{A character string indicating whether to return results (\code{"get"}) or add them to metadata (\code{"add"}). Default is \code{"add"}.}
}
\value{
If \code{action = "add"}, returns the modified \code{expomicset} with significant factors stored in metadata.
If \code{action = "get"}, returns a data frame containing:
\item{factor}{The latent factor being tested.}
\item{outcome}{The outcome variable.}
\item{estimate}{The test statistic (correlation coefficient or Kruskal-Wallis chi-squared).}
\item{p.value}{The p-value of the test.}
}
\description{
Tests associations between integration-derived latent factors and an outcome
using correlation or Kruskal-Wallis tests, depending on whether the outcome is categorical.
Applies multiple testing correction and optionally stores results in \code{expomicset} metadata.
}
\details{
The function extracts integration-derived factors from \code{metadata(expomicset)} based on the integration method
(\code{"MOFA"} or \code{"MCIA"}). It then matches factor sample identifiers with those of the outcome and performs
either Spearman correlation (\code{cor.test()}) for continuous outcomes or a Kruskal-Wallis test (\code{kruskal.test()})
for categorical outcomes. Significant results (\code{p.value < p_thresh}) are retained.
}
\examples{
\dontrun{
results <- associate_factor_outcome(
  expomicset = my_expomicset,
  outcome_var = "fev_height",
  categorical = TRUE,
  p_thresh = 0.05,
  action = "get"
)
}

}
