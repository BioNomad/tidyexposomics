% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/associate_go_outcome.R
\name{associate_go_outcome}
\alias{associate_go_outcome}
\title{Associate Gene Ontology (GO) Enrichment with an Outcome}
\usage{
associate_go_outcome(
  expomicset,
  geneset,
  outcome,
  mirna_assays = NULL,
  covariates = NULL,
  action = "add"
)
}
\arguments{
\item{expomicset}{A \code{MultiAssayExperiment} object containing functional enrichment data.}

\item{geneset}{A character string specifying the name of the gene set to analyze.}

\item{outcome}{A character string specifying the outcome variable name.}

\item{mirna_assays}{An optional character vector of miRNA assays to exclude. Default is \code{NULL}.}

\item{covariates}{An optional character vector of covariate names. Default is \code{NULL}.}

\item{action}{A character string indicating whether to return results (\code{"get"}) or add them to metadata (\code{"add"}). Default is \code{"add"}.}
}
\value{
If \code{action = "add"}, returns the modified \code{expomicset} with PCA-GLM results stored in metadata.
If \code{action = "get"}, returns a data frame containing:
\item{term}{The PC term tested in the GLM.}
\item{estimate}{The regression coefficient for the association.}
\item{std.error}{The standard error of the estimate.}
\item{statistic}{The test statistic from the GLM.}
\item{p.value}{The p-value of the association test.}
\item{top_terms}{The top GO terms associated with the PC.}
\item{genes}{The genes contributing to the PC.}
\item{outcome}{The outcome variable tested.}
}
\description{
Performs principal component analysis (PCA) on genes within GO enrichment results
and tests for associations with an outcome using generalized linear models (GLMs).
Optionally stores results in \code{expomicset} metadata.
}
\details{
The function retrieves functional enrichment results from \code{metadata(expomicset)}, filters based on the selected gene set,
and extracts genes for PCA. The first principal component (PC1) of each GO enrichment group is computed and tested
for association with the outcome using a GLM. The results include model statistics and gene annotations.
}
\examples{
\dontrun{
results <- associate_go_outcome(
  expomicset = expom,
  geneset = "deg_exp_cor",
  outcome = "fev_height",
  mirna_assays = c("CD4+ T-cell miRNA"),
  covariates = c("age", "sex"),
  action = "get"
)
}

}
