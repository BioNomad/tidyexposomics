<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Integrated Exposure-Omics Analysis Powered by Tidy Principles • tidyexposomics</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Atkinson_Hyperlegible-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Integrated Exposure-Omics Analysis Powered by Tidy Principles">
<meta name="description" content="The tidyexposomics package is designed to facilitate the integration of exposure and omics data to identify exposure-omics associations. We structure our commands to fit into the tidyverse framework, where commands are designed to be simplified and intuitive. Here we provide functionality to perform quality control, sample and exposure association analysis, differential abundance analysis, multi-omics integration, and functional enrichment analysis.">
<meta property="og:description" content="The tidyexposomics package is designed to facilitate the integration of exposure and omics data to identify exposure-omics associations. We structure our commands to fit into the tidyverse framework, where commands are designed to be simplified and intuitive. Here we provide functionality to perform quality control, sample and exposure association analysis, differential abundance analysis, multi-omics integration, and functional enrichment analysis.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tidyexposomics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/tidyexposomics.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/faq.html">FAQ</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tidyexposomics--integrated-exposure-omics-analysis-powered-by-tidy-principles">tidyexposomics <a href="#"><img src="articles/logo.png" align="right" width="25%"></a><br><span style="font-size: 0.5em">Integrated exposure-omics analysis powered by tidy principles</span>
<a class="anchor" aria-label="anchor" href="#tidyexposomics--integrated-exposure-omics-analysis-powered-by-tidy-principles"></a>
</h1></div>
<p><br><br></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>tidyexposomics</code> package is designed to facilitate the integration of exposure and omics data to identify exposure-omics associations. We structure our commands to fit into the tidyverse framework, where commands are designed to be simplified and intuitive. Here we provide functionality to perform quality control, sample and exposure association analysis, differential abundance analysis, multi-omics integration, and functional enrichment analysis.</p>
<p align="center" width="100%">
<img width="80%" src="articles/overview.png"></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>tidyexposomics</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install directly through GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"BioNomad/tidyexposomics"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="command-structure">Command Structure<a class="anchor" aria-label="anchor" href="#command-structure"></a>
</h2>
<p>To make the package more user-friendly, we have named our functions to be more intuitive. For example, we use the following naming conventions:</p>
<p align="center" width="100%">
<img width="80%" src="articles/command_str.png"></p>
<p>We provide functionality to either <code>add</code> results to the existing object storing the omics/exposure data or to return the direct results using the <code>get</code> option using the <code>action</code> argument. We suggest adding results, as we also include a <code><a href="reference/run_pipeline_summary.html">run_pipeline_summary()</a></code> function to generate a diagram of the workflow. This is useful for keeping track of the pipeline steps.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>The following code is a great way to get started with the package. It includes loading example data, performing basic quality control, running exposure-wide association studies (ExWAS), differential abundance analysis, correlating differentially expressed genes (DEGs) with exposures, and functional enrichment analysis.</p>
<div class="callout">
<h3>
More to tidyexposomics!
</h3>
<p>
However, there is so much more to the <code>tidyexposomics</code> package! So check out the <a href="articles/tidyexposomics.html">Get Started</a> page for a more detailed walkthrough of the package’s functionality.
</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and Load Packages</span></span>
<span><span class="co"># -------------------------</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"BioNomad/tidyexposomics"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tidyexposomics</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Load Example Data</span></span>
<span></span>
<span><span class="va">omics_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gene Expression"</span> <span class="op">=</span> <span class="va">exp</span>,</span>
<span>  <span class="st">"Metabolomics"</span> <span class="op">=</span> <span class="va">met</span>,</span>
<span>  <span class="st">"Proteomics"</span> <span class="op">=</span> <span class="va">prot</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gene Expression"</span> <span class="op">=</span> <span class="va">exp_fdata</span>,</span>
<span>  <span class="st">"Metabolomics"</span> <span class="op">=</span> <span class="va">met_fdata</span>,</span>
<span>  <span class="st">"Proteomics"</span> <span class="op">=</span> <span class="va">prot_fdata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create MultiAssayExperiment container</span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_expomicset.html">create_expomicset</a></span><span class="op">(</span></span>
<span>  var_info <span class="op">=</span> <span class="va">des</span>,</span>
<span>  exposure <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  omics <span class="op">=</span> <span class="va">omics_list</span>,</span>
<span>  row_data <span class="op">=</span> <span class="va">fdata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify exposure variables</span></span>
<span><span class="va">exp_vars</span> <span class="op">&lt;-</span> <span class="va">des</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"exposure|chemical"</span>, <span class="va">category</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic Quality Control</span></span>
<span><span class="co"># ---------------------</span></span>
<span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/filter_missing.html">filter_missing</a></span><span class="op">(</span>na_thresh <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/run_impute_missing.html">run_impute_missing</a></span><span class="op">(</span></span>
<span>    exposure_impute_method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    omics_impute_method <span class="op">=</span> <span class="st">"median"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/run_pca.html">run_pca</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"add"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/filter_sample_outliers.html">filter_sample_outliers</a></span><span class="op">(</span>outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s411"</span>,<span class="st">"s378"</span>, <span class="st">"s588"</span>, <span class="st">"s764"</span>, <span class="st">"s857"</span>, <span class="st">"s918"</span>, <span class="st">"s936"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/run_normality_check.html">run_normality_check</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"add"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/transform_exposure.html">transform_exposure</a></span><span class="op">(</span>transform_method <span class="op">=</span> <span class="st">"boxcox_best"</span>, cols_of_interest <span class="op">=</span> <span class="va">exp_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exposure-Wide Association (ExWAS)</span></span>
<span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">associate_exposure_outcome</span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="st">"hs_asthma"</span>,</span>
<span>    exposures <span class="op">=</span> <span class="va">exp_vars</span><span class="op">[</span><span class="op">!</span><span class="va">exp_vars</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hs_asthma"</span>, <span class="st">"hs_child_age"</span>, <span class="st">"e3_sex"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hs_child_age"</span>, <span class="st">"e3_sex"</span><span class="op">)</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>    action <span class="op">=</span> <span class="st">"add"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot significant associations</span></span>
<span><span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_associate_exposure_outcome</span><span class="op">(</span></span>
<span>    subtitle <span class="op">=</span> <span class="st">"Covariates: Age, Sex"</span>,</span>
<span>    result <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    filter_thresh <span class="op">=</span> <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Differential Abundance Analysis</span></span>
<span><span class="co"># -------------------------------</span></span>
<span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/run_differential_abundance.html">run_differential_abundance</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="op">~</span> <span class="va">hs_asthma</span> <span class="op">+</span> <span class="va">hs_child_age</span> <span class="op">+</span> <span class="va">e3_sex</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"limma_voom"</span>,</span>
<span>    minimum_counts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    minimum_proportion <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    scaling_method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    action <span class="op">=</span> <span class="st">"add"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot results as volcano plot</span></span>
<span><span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/plot_volcano.html">plot_volcano</a></span><span class="op">(</span></span>
<span>    top_n_label <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    logFC_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    pval_thresh <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Correlate DEGs with Exposures</span></span>
<span><span class="co"># -----------------------------</span></span>
<span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">correlate_exposures_degs</span><span class="op">(</span></span>
<span>    exposure_cols <span class="op">=</span> <span class="va">exp_vars</span>,</span>
<span>    robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    score_thresh <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    deg_logfc_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    deg_pval_thresh <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    correlation_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    pval_cutoff <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    action <span class="op">=</span> <span class="st">"add"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Functional Enrichment Analysis</span></span>
<span><span class="co"># ------------------------------</span></span>
<span></span>
<span><span class="va">expom</span> <span class="op">&lt;-</span> <span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/run_enrichment.html">run_enrichment</a></span><span class="op">(</span></span>
<span>    geneset <span class="op">=</span> <span class="st">"deg_exp_cor"</span>,</span>
<span>    feature_col <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>    clustering_approach <span class="op">=</span> <span class="st">"dynamic"</span>,</span>
<span>    pval_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    pAdjustMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    qvalueCutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    logfc_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    action <span class="op">=</span> <span class="st">"add"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot enriched terms (dotplot)</span></span>
<span><span class="va">expom</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/plot_dotplot_enrichment.html">plot_dotplot_enrichment</a></span><span class="op">(</span></span>
<span>    geneset <span class="op">=</span> <span class="st">"deg_exp_cor"</span>,</span>
<span>    top_n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    n_per_group <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    add_top_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    top_n_genes <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>`use_mit_license()`, `use_gpl3_license()` or friends to pick a license</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tidyexposomics</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jason Laird <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Laird.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
